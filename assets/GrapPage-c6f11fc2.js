import{m as o,r as m,u as i,k as j,h as R,n as P,i as k,l as h,p as A,o as J,C as Q,j as s,L as $,q as V}from"./index-0e8f3c6f.js";/* empty css               */import{L as W}from"./LoadingModal-9c8080d8.js";import{D as z}from"./Dates-f6439e7d.js";import{R as X}from"./index-cf021b95.js";import{u as Y}from"./useDispatch-b139ab9d.js";import"./v4-4a60fe23.js";const n=e=>e.product,Z=o([n],e=>e.loading),U=o([n],e=>e.exportLoading),f=o([n],e=>e.rows),ss=o([n],e=>e.sorter||{}),es=o([n],e=>{const t=e.sorter;if(!t||!t.field)return null;let _=t.order==="descend"?"DESC":"ASC";return`${t.field}_${_}`}),as=o([n],e=>e.filter),ts=o([n],e=>e.rawFilter),ls=o([n],e=>e.pagination.pageSize),rs=o([n],e=>{const t=e.pagination;return!t||!t.pageSize?0:((t.current||1)-1)*t.pageSize}),E=o([n],e=>e.selectedKeys),cs=o([n,f],(e,t)=>t.filter(_=>e.selectedKeys.includes(_.id))),os=o([f,E],(e,t)=>e.length===t.length),D={selectLoading:Z,selectRows:f,selectOrderBy:es,selectLimit:ls,selectFilter:as,selectOffset:rs,selectSelectedKeys:E,selectSelectedRows:cs,selectExportLoading:U,selectRawFilter:ts,selectIsAllSelected:os,selectSorter:ss},ps=()=>{var w,F,y,C,L;const[e,t]=m.useState(0),_=l=>{t(l)},x=i(j.selectTotalPerday),I=i((w=R)==null?void 0:w.selectLoading),M=i(R.selectRows);P();const c=Y(),d=i(k.selectCurrentUser),a=i(D.selectRows),N=i(D.selectLoading),[O,p]=m.useState(!1),[v,g]=m.useState(!1),b=i(j.selectCountRecord),B=i(j.selectError),K=m.useCallback(async()=>{try{await c(h.doFetch()),await c(A.doFetch()),await c(J.doRefreshCurrentUser()),await c(h.doCountDay())}catch(l){console.error("Error during refreshing items:",l)}},[c]);m.useMemo(()=>{var l;return parseInt(b)===parseInt((l=d==null?void 0:d.vip)==null?void 0:l.dailyorder)},[b,d]);const T=async()=>{try{if(g(!0),await c(h.doCheck()),B)return;await c(A.doFetch()),setTimeout(()=>{p(!0)},1e3),g(!1)}catch{g(!1)}},q=()=>{p(!1)},[S]=m.useState(z.Number());m.useEffect(()=>{c(h.doCount()),c(Q.doFetch()),c(h.doCountDay())},[c]);const G=(l,u)=>(parseFloat(u)/100*parseFloat(l)).toFixed(3),r=i(k.selectCurrentUser),H=async()=>{const l={number:S,product:a==null?void 0:a.id,status:a!=null&&a.combo?"pending":"completed",user:r.id,rating:e};await c(V.doCreate(l)),await K(),p(!1)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"market__header",children:!I&&M.map(l=>{var u;return s.jsx("img",{src:(u=l==null?void 0:l.photo[0])==null?void 0:u.downloadUrl,alt:"",className:"logo__header"})})}),s.jsxs("div",{className:"app__grappage",children:[s.jsx("div",{className:"grap__movies",children:s.jsx("img",{src:"/images/start_img.gif",alt:""})}),s.jsxs("div",{className:"button__start",children:[s.jsx("button",{disabled:v,className:`button__grapstart ${v?"__disabled":""}`,onClick:()=>T(),children:"Start"}),s.jsx($,{to:"/order",className:"butoon__order remove__lg",children:"Orders"})]}),s.jsx("div",{className:"terms__",children:s.jsx("span",{children:s.jsx($,{to:"/tc",className:"remove__lg",children:"terms & conditions"})})}),s.jsxs("div",{className:"film__score",children:[s.jsxs("div",{className:"film__sc",children:[s.jsxs("div",{className:"grap__page",children:[" ","$",r==null?void 0:r.balance.toFixed(2)]}),s.jsxs("div",{className:"grap__",children:[r==null?void 0:r.tasksDone,"/",(F=d==null?void 0:d.vip)==null?void 0:F.dailyorder]})]}),s.jsxs("div",{className:"film__cadre",children:[s.jsxs("div",{className:"cadre__filma",children:[s.jsx("span",{className:"av__balance",children:"Today's earnings: "}),s.jsxs("label",{htmlFor:"",className:"balance__film",children:["$",x==null?void 0:x.toFixed(3)]})]}),s.jsxs("div",{className:"cadre__filma",children:[s.jsx("span",{className:"av__balance",children:"Account Balance : "}),s.jsxs("label",{htmlFor:"",className:"balance__film",children:["$",r==null?void 0:r.balance.toFixed(2)]})]}),s.jsxs("div",{className:"cadre__filma",children:[s.jsx("span",{className:"av__balance",children:"Freeze Balance : "}),s.jsxs("label",{htmlFor:"",className:"balance__film",children:["$",(y=r==null?void 0:r.freezeblance)==null?void 0:y.toFixed(2)]})]})]})]}),N&&s.jsx(W,{}),!N&&O&&a&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"film__modal",children:[s.jsx("div",{className:"film__modal__close",onClick:()=>q(),children:s.jsx("i",{className:"fa fa-close",style:{color:"white",fontSize:35}})}),s.jsxs("div",{className:"film__details",children:[s.jsxs("div",{className:"submit__information",children:[s.jsx("span",{className:"submit__information__title",children:"Submit Information"}),(a==null?void 0:a.photo)&&((C=a==null?void 0:a.photo[0])==null?void 0:C.downloadUrl)&&s.jsx("img",{src:(L=a==null?void 0:a.photo[0])==null?void 0:L.downloadUrl,alt:"",style:{width:"120px"}}),s.jsx("h3",{className:"grap__titleh3",children:a==null?void 0:a.title})]}),s.jsxs("div",{className:"creation__time",children:[s.jsx("span",{className:"title__creation",children:"Creation time:"}),s.jsx("label",{htmlFor:"",className:"date__creation",children:z.current()})]}),s.jsxs("div",{className:"order__number",children:[s.jsxs("div",{children:[s.jsx("span",{className:"tile",children:"Order Number:"}),s.jsx("span",{children:S})]}),s.jsxs("div",{children:[s.jsx("span",{className:"tile",children:"Order amount:"}),s.jsxs("span",{children:["$",a==null?void 0:a.amount]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"tile",children:"Income"}),s.jsxs("span",{children:["$",G(a==null?void 0:a.amount,a==null?void 0:a.commission)]})]})]}),s.jsxs("div",{className:"rating__box",children:[s.jsxs("div",{className:"buyer__rating",children:["Buyer Ratings (",e,"/5)"]}),s.jsxs("div",{children:[" ",s.jsx(X,{onClick:_,size:20})]})]}),s.jsx("div",{className:"rating__submit",onClick:()=>H(),children:"Submit"})]})]})})]})]})};export{ps as default};
